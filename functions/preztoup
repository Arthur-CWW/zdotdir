# updates zprezto, and the contrib dependencies
zprezto-update
local d f
for d in $ZPREZTODIR/contrib/*/external/.git; do
  echo "Updating $d:h:t"
  git -C "$d/.." pull
  echo ""
done

if [[ -d $ZDOTDIR/.zprezto-contrib ]]; then
  echo "Updating zprezto-contrib"
  git -C $ZDOTDIR/.zprezto-contrib pull
fi

autoload -U zrecompile
echo "Compiling Zsh files"
for f in "$ZPREZTODIR"/**/*.zwc(.N) "$ZPREZTODIR"/**/*.zwc.old(.N); do
  command rm -f "$f"
done
for f in "$ZPREZTODIR"/**/*.zsh{,-theme}; do
  zrecompile -pq "$f"
done
